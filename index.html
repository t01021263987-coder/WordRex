<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>WordRex - Vocabulary Master</title>
    <style>
        :root { --wm-yellow: #FFD400; --wm-navy: #004680; --wm-red: #ff4d4d; --wm-green: #28a745; --wm-blue: #2196F3; }
        body { margin: 0; height: 100vh; overflow: hidden; display: flex; justify-content: center; align-items: center; background: #f4f4f4; font-family: 'Pretendard', sans-serif; }

        /* íƒ€ì´í‹€ ë””ìì¸ */
        #main-title { font-size: 3rem; font-weight: 900; color: var(--wm-navy); margin-bottom: 20px; letter-spacing: -1px; }

        /* ìƒë‹¨ ì§„í–‰ë¥  (ì´ˆê¸° ìˆ¨ê¹€) */
        #progress-box { position: fixed; top: 20px; left: 20px; font-size: 1.5rem; font-weight: bold; color: var(--wm-navy); z-index: 50; display: none; }

        /* íƒ€ì„ ë°” (ìœ„ì—ì„œ ì•„ë˜ë¡œ) */
        #time-bar-container { position: fixed; right: 30px; top: 50%; transform: translateY(-50%); width: 20px; height: 300px; background: #ddd; border-radius: 10px; overflow: hidden; display: none; }
        #time-bar-fill { width: 100%; height: 100%; background: var(--wm-red); position: absolute; top: 0; }

        /* ë ˆì´ì•„ì›ƒ ì œì–´ */
        #setup-screen, #test-screen, #result-screen, #ranking-screen { width: 100%; max-width: 500px; text-align: center; display: none; }
        #main-menu { display: block; text-align: center; }

        /* ë‹¨ì–´ì¥ í‘œì§€ ì˜¤ë²„ë ˆì´ */
        .book-card { width: 280px; height: 400px; margin: auto; position: relative; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); background: url('cover.png') center/cover; cursor: pointer; }
        .book-card .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 70, 128, 0.92); display: flex; flex-direction: column; justify-content: center; align-items: center; opacity: 0; transition: opacity 0.3s; color: white; padding: 20px; box-sizing: border-box; }
        .book-card:hover .overlay { opacity: 1; }

        /* í€´ì¦ˆ UI */
        .quiz-container { background: white; padding: 40px; border-radius: 25px; border-top: 10px solid var(--wm-yellow); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .word-eng { font-size: 3.5rem; color: var(--wm-navy); margin-bottom: 20px; }
        .option-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .opt-btn { padding: 15px; border: none; background: #f0f0f0; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold; transition: 0.2s; }
        .opt-btn:disabled { opacity: 0.3; }

        /* ì¹´ìš´íŠ¸ë‹¤ìš´ ìˆ«ì */
        #countdown { position: fixed; display: none; font-size: 10rem; color: var(--wm-yellow); font-weight: 900; text-shadow: 8px 8px 0px var(--wm-navy), -4px -4px 0px var(--wm-navy); z-index: 200; }

        /* í”¼ë“œë°± ë ˆì´ì–´ */
        #feedback-layer { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; opacity: 0; z-index: 100; text-align: center; }
        #feedback-img { width: 250px; opacity: 0.4; }
        #feedback-points { font-size: 4.5rem; font-weight: 900; margin-top: -20px; }

        /* ë²„íŠ¼ë¥˜ */
        .action-btn { width: 100%; padding: 18px; margin: 8px 0; border: none; border-radius: 12px; font-size: 1.3rem; cursor: pointer; background: white; color: var(--wm-navy); font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: 0.2s; }
        .action-btn:hover { background: var(--wm-yellow); }
        .rank-go-btn { background: var(--wm-blue); color: white; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="progress-box"><span id="curr-num">0</span> / <span id="total-num">0</span></div>
    <div id="time-bar-container"><div id="time-bar-fill"></div></div>
    <div id="countdown"></div>

    <div id="main-menu">
        <div id="main-title">WordRex</div>
        <div class="book-card" onclick="showSetup()">
            <div class="overlay">
                <div style="color:var(--wm-yellow); font-size: 1.5rem;">â­â­â­</div>
                <p>ê³ ë“± ê¸°ì´ˆ í•„ìˆ˜ ì˜ë‹¨ì–´ 1200</p>
                <div style="margin-top:20px; background:var(--wm-yellow); color:var(--wm-navy); padding:10px 20px; border-radius:20px; font-weight:bold;">CLICK TO START</div>
            </div>
        </div>
    </div>

    <div id="setup-screen">
        <h2 style="color:var(--wm-navy);">í…ŒìŠ¤íŠ¸ ë¬¸í•­ ìˆ˜ ì„ íƒ</h2>
        <button class="action-btn" onclick="initGame(5)">5 ë¬¸í•­</button>
        <button class="action-btn" onclick="initGame(15)">15 ë¬¸í•­</button>
        <button class="action-btn" onclick="initGame(30)">30 ë¬¸í•­</button>
    </div>

    <div id="test-screen">
        <div class="quiz-container">
            <div class="word-eng" id="word-display">Word</div>
            <div class="option-grid" id="option-area"></div>
            <div style="margin-top:25px; font-weight: bold; font-size: 1.3rem;">Score: <span id="score">0</span></div>
        </div>
    </div>

    <div id="result-screen">
        <h2 style="color:#666;">TEST COMPLETE</h2>
        <div style="font-size:5rem; font-weight:900; color:var(--wm-navy); margin-bottom: 20px;" id="final-score">0</div>
        <button class="action-btn" onclick="location.reload()">ë‹¤ì‹œ í•˜ê¸°</button>
        <button class="action-btn rank-go-btn" onclick="showRanking()">ğŸ† ë­í‚¹ í™•ì¸í•˜ê¸°</button>
    </div>

    <div id="feedback-layer">
        <img id="feedback-img" src="">
        <div id="feedback-points"></div>
    </div>

    <audio id="snd-correct" src="correct.mp3"></audio>
    <audio id="snd-wrong" src="wrong.mp3"></audio>

    <script>
        const wordData = [
            { eng: "include", kor: "í¬í•¨í•˜ë‹¤", opts: ["ì œì™¸í•˜ë‹¤", "í¬í•¨í•˜ë‹¤", "ë§‰ë‹¤", "ì˜ˆì¸¡í•˜ë‹¤", "ì¤‘ìš”ì„±"] },
            { eng: "produce", kor: "ìƒì‚°í•˜ë‹¤", opts: ["ì†Œë©¸í•˜ë‹¤", "ìƒì‚°í•˜ë‹¤", "ê°ì†Œí•˜ë‹¤", "ê³µìœ í•˜ë‹¤", "í‰ê°€í•˜ë‹¤"] },
            { eng: "belief", kor: "ë¯¿ìŒ", opts: ["ë¶ˆì‹ ", "ë¯¿ìŒ", "ê±°ë¶€", "í‘œí˜„", "ì‹¤í˜„"] },
            { eng: "similar", kor: "ë¹„ìŠ·í•œ", opts: ["ë¹„ìŠ·í•œ", "ë‹¬ë¼ì§„", "ì¤‘ìš”í•œ", "í–‰ë™í•˜ë‹¤", "ì„±ì¥"] },
            { eng: "moment", kor: "ìˆœê°„", opts: ["ìˆœê°„", "ì˜ˆì¸¡í•˜ë‹¤", "í¬í•¨í•˜ë‹¤", "ê°ì •", "ê³µê¸‰í•˜ë‹¤"] },
            { eng: "emotion", kor: "ê°ì •", opts: ["ê°ì •", "ê³µê¸‰", "í‘œí˜„", "ë°œìƒ", "ì°¨ì´"] },
            { eng: "common", kor: "í”í•œ", opts: ["í¬ê·€í•œ", "í”í•œ", "ìƒê¸‰ì˜", "ë¶€ì •", "ì‹¤ìš©ì ì¸"] },
            { eng: "recover", kor: "íšŒë³µí•˜ë‹¤", opts: ["íšŒë³µí•˜ë‹¤", "ì œê³µí•˜ë‹¤", "ì´í•´í•˜ë‹¤", "ë°œìƒí•˜ë‹¤", "ì‹¤íŒ¨"] },
            { eng: "advanced", kor: "ì§„ë³´í•œ", opts: ["ê¸°ì´ˆì ì¸", "ì§„ë³´í•œ", "ì¼ë°˜ì ì¸", "ê±°ë¶€í•˜ëŠ”", "í‘œí˜„í•˜ëŠ”"] },
            { eng: "indifferent", kor: "ë¬´ê´€ì‹¬í•œ", opts: ["ë¬´ê´€ì‹¬í•œ", "ê³µê¸‰í•˜ëŠ”", "ê³µìœ í•˜ëŠ”", "ì¤‘ìš”í•œ", "í¬í•¨í•˜ë‹¤"] },
            { eng: "consider", kor: "ê³ ë ¤í•˜ë‹¤", opts: ["ê³ ë ¤í•˜ë‹¤", "ë¬´ì‹œí•˜ë‹¤", "íšŒë³µí•˜ë‹¤", "ì œê³µí•˜ë‹¤", "í‘œí˜„í•˜ë‹¤"] },
            { eng: "supply", kor: "ê³µê¸‰í•˜ë‹¤", opts: ["ê³µê¸‰í•˜ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ìƒì‚°í•˜ë‹¤", "ì„±ê³µí•˜ë‹¤", "ê°ì •"] },
            { eng: "practical", kor: "ì‹¤ìš©ì ì¸", opts: ["ì‹¤ìš©ì ì¸", "ì´ë¡ ì ì¸", "ê°ì •ì ì¸", "ì„±ê³µì ì¸", "ë¬´ê´€ì‹¬í•œ"] },
            { eng: "express", kor: "í‘œí˜„í•˜ë‹¤", opts: ["í‘œí˜„í•˜ë‹¤", "ìˆ¨ê¸°ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ì¤‘ìš”í•˜ë‹¤", "í¬í•¨í•˜ë‹¤"] },
            { eng: "fade", kor: "í¬ë¯¸í•´ì§€ë‹¤", opts: ["í¬ë¯¸í•´ì§€ë‹¤", "ì„±ê³µí•˜ë‹¤", "ì œê³µí•˜ë‹¤", "ê°ì •", "íšŒë³µí•˜ë‹¤"] },
            { eng: "disappear", kor: "ì‚¬ë¼ì§€ë‹¤", opts: ["ë‚˜íƒ€ë‚˜ë‹¤", "ì‚¬ë¼ì§€ë‹¤", "ë°œìƒí•˜ë‹¤", "ê°ì •", "í¬í•¨í•˜ë‹¤"] },
            { eng: "emerge", kor: "ë‚˜íƒ€ë‚˜ë‹¤", opts: ["ì‚¬ë¼ì§€ë‹¤", "ë‚˜íƒ€ë‚˜ë‹¤", "í¬í•¨í•˜ë‹¤", "ì„±ê³µí•˜ë‹¤", "í‘œí˜„í•˜ë‹¤"] },
            { eng: "grief", kor: "ìŠ¬í””", opts: ["ìŠ¬í””", "ê¸°ì¨", "ì¤‘ìš”ì„±", "ì‹¤ìš©ì ", "ê°ì •"] },
            { eng: "slight", kor: "ì•½ê°„ì˜", opts: ["ì•½ê°„ì˜", "ì¤‘ëŒ€í•œ", "ì„±ê³µì ì¸", "ê°ì •", "í¬í•¨í•˜ë‹¤"] },
            { eng: "success", kor: "ì„±ê³µ", opts: ["ì‹¤íŒ¨", "ì„±ê³µ", "ê°ì •", "í¬í•¨í•˜ë‹¤", "ì¤‘ìš”"] }
        ];

        let gameWords = [];
        let currentIdx = 0;
        let score = 0;
        let isClickable = false;
        let timerInterval;
        let timeLeft = 8;

        function showSetup() {
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('setup-screen').style.display = 'block';
        }

        function initGame(count) {
            gameWords = [...wordData].sort(() => Math.random() - 0.5).slice(0, count);
            document.getElementById('total-num').innerText = gameWords.length;
            document.getElementById('setup-screen').style.display = 'none';
            startCountdown();
        }

        function startCountdown() {
            const countEl = document.getElementById('countdown');
            countEl.style.display = 'block';
            const sequence = ["3", "2", "1", "GO!"];
            let i = 0;

            const timer = setInterval(() => {
                if (i < sequence.length) {
                    countEl.innerText = sequence[i];
                    i++;
                } else {
                    clearInterval(timer);
                    countEl.style.display = 'none';
                    document.getElementById('progress-box').style.display = 'block';
                    document.getElementById('test-screen').style.display = 'block';
                    document.getElementById('time-bar-container').style.display = 'block';
                    loadQuestion();
                }
            }, 800);
        }

        function loadQuestion() {
            if (currentIdx >= gameWords.length) {
                endGame();
                return;
            }
            isClickable = true;
            timeLeft = 8;
            updateTimeBar();
            
            document.getElementById('curr-num').innerText = currentIdx + 1;
            const q = gameWords[currentIdx];
            document.getElementById('word-display').innerText = q.eng;

            const optArea = document.getElementById('option-area');
            optArea.innerHTML = "";
            [...q.opts].sort(() => Math.random() - 0.5).forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'opt-btn';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(opt, btn);
                optArea.appendChild(btn);
            });

            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft -= 0.1;
                updateTimeBar();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    checkAnswer("TIME_OUT", null);
                }
            }, 100);
        }

        function updateTimeBar() {
            const fill = document.getElementById('time-bar-fill');
            fill.style.height = (timeLeft / 8 * 100) + "%";
        }

        function checkAnswer(input, btn) {
            if (!isClickable) return;

            const correct = gameWords[currentIdx].kor;
            const layer = document.getElementById('feedback-layer');
            const img = document.getElementById('feedback-img');
            const pts = document.getElementById('feedback-points');

            if (input === correct) {
                isClickable = false; // ì •ë‹µ ì‹œ í´ë¦­ ì ê¸ˆ
                clearInterval(timerInterval);
                score += 100;
                document.getElementById('snd-correct').play();
                img.src = "good.png";
                pts.innerText = "+100";
                pts.style.color = "var(--wm-green)";
                
                layer.style.opacity = "1";
                setTimeout(() => { 
                    layer.style.opacity = "0";
                    currentIdx++; 
                    loadQuestion(); 
                }, 800);
            } else {
                // ì˜¤ë‹µ ì‹œ ë”œë ˆì´ ë¡œì§ ì¶”ê°€ (ì¤‘ë³µ í´ë¦­ ë°©ì§€)
                isClickable = false;
                score -= 50;
                document.getElementById('snd-wrong').play();
                img.src = "ë˜¥.png";
                pts.innerText = "-50";
                pts.style.color = "var(--wm-red)";
                
                if (btn) btn.disabled = true;

                layer.style.opacity = "1";
                setTimeout(() => { 
                    layer.style.opacity = "0"; 
                    if (input === "TIME_OUT") {
                        currentIdx++;
                        loadQuestion();
                    } else {
                        isClickable = true; // í‹€ë¦° í›„ ì ì‹œ ë’¤ ë‹¤ì‹œ í´ë¦­ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •
                    }
                }, 800);
            }
            document.getElementById('score').innerText = score;
        }

        function endGame() {
            document.getElementById('test-screen').style.display = 'none';
            document.getElementById('time-bar-container').style.display = 'none';
            document.getElementById('progress-box').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            document.getElementById('final-score').innerText = score;
        }

        function showRanking() {
            alert("ì´ì  " + score + "ì ìœ¼ë¡œ ë­í‚¹ 8ìœ„ì— ë“±ê·¹í•˜ì…¨ìŠµë‹ˆë‹¤! (ê°€ìƒ ë°ì´í„°)");
            location.reload();
        }
    </script>
</body>
</html>