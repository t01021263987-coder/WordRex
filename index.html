<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>WordRex - Master</title>
    <style>
        :root { 
            --wm-yellow: #FFD400; --wm-navy: #004680; --wm-red: #ff4d4d; 
            --wm-green: #28a745; --wm-blue: #2196F3;
        }
        body { margin: 0; height: 100vh; display: flex; background: #f4f4f4; font-family: 'Pretendard', sans-serif; overflow: hidden; }

        #main-container { flex: 1; display: flex; justify-content: center; align-items: center; position: relative; width: 100%; height: 100%; }

        /* í™ˆ í™”ë©´ ìŠ¬ë¼ì´ë” */
        #main-menu { display: block; text-align: center; width: 100%; }
        .slider-wrapper { 
            position: relative; width: 1000px; margin: 0 auto; 
            display: flex; align-items: center; justify-content: center; height: 500px; 
        }
     
        /* ê²°ê³¼ í™”ë©´ ë²„íŠ¼ ìŠ¤íƒ€ì¼ í†µì¼ */
.secondary-btn { 
    width: 100%; padding: 18px; margin-top: 10px; border: 2px solid var(--wm-navy); 
    border-radius: 12px; font-size: 1.2rem; cursor: pointer; 
    background: white; color: var(--wm-navy); font-weight: bold; transition: 0.2s;
}
.secondary-btn:hover { background: #f0f7ff; }

/* ì˜¤ë‹µ ë¦¬ìŠ¤íŠ¸ í™”ë©´ ìŠ¤íƒ€ì¼ */
#review-screen { width: 100%; max-width: 500px; text-align: center; display: none; padding: 20px; z-index: 10; }
.review-container { 
    background: white; padding: 30px; border-radius: 25px; 
    box-shadow: 0 10px 25px rgba(0,0,0,0.1); max-height: 400px; overflow-y: auto; 
    margin-bottom: 20px; text-align: left;
}
.review-item { 
    display: flex; justify-content: space-between; align-items: center;
    padding: 15px 0; border-bottom: 1px solid #eee; 
}
.review-item:last-child { border-bottom: none; }
.review-eng { font-size: 1.4rem; font-weight: bold; color: var(--wm-navy); }
.review-kor { font-size: 1.1rem; color: #666; }

/* í•˜ë‹¨ ë²„íŠ¼ ê·¸ë£¹ */
.btn-group { display: flex; gap: 10px; margin-top: 10px; }
.half-btn { flex: 1; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; border: none; font-size: 1rem; }
.btn-home { background: #eee; color: #333; }
.btn-retry { background: var(--wm-red); color: white; }
        
        .book-container { position: relative; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; }

        .book-card {
    width: 280px;
    height: 400px;
    position: absolute;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 15px 35px rgba(0,0,0,0.2);
    background-size: cover;
    background-position: center;
    cursor: pointer;

    transition:
        transform 0.8s cubic-bezier(0.22, 1, 0.36, 1),
        opacity 0.5s ease;
    will-change: transform;

    opacity: 0;
    transform: scale(0.5);
    z-index: 0;
}

        /* ì¹´ë“œ ê°„ê²© ë° ë ˆì´ì•„ì›ƒ */
        .book-card.active { opacity: 1; transform: scale(1) translateX(0); z-index: 10; pointer-events: auto; }
        .book-card.prev { opacity: 1; transform: scale(0.8) translateX(-380px); z-index: 5; pointer-events: auto; }
        .book-card.next { opacity: 1; transform: scale(0.8) translateX(380px); z-index: 5; pointer-events: auto; }

        .book-card .overlay { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0, 70, 128, 0.95); display: flex; flex-direction: column; 
            justify-content: center; align-items: center; color: white; padding: 25px; 
            box-sizing: border-box; opacity: 0; transition: opacity 0.3s ease; 
        }
        .book-card:hover .overlay {opacity: 1;}

        .overlay h3 { color: var(--wm-yellow); margin: 10px 0; font-size: 1.5rem; }
        .stars { color: #FFD400; margin-bottom: 10px; font-size: 1.2rem; }
        .start-badge { background: var(--wm-yellow); color: var(--wm-navy); padding: 10px 20px; border-radius: 25px; font-weight: bold; margin-top: 20px; }

        .slide-btn { 
            position: absolute; top: 50%; transform: translateY(-50%); 
            background: white; border: none; width: 55px; height: 55px; border-radius: 50%; 
            cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.1); font-size: 1.8rem; z-index: 100;
        }
        .prev-btn { left: 0; }
        .next-btn { right: 0; }

        /* í€´ì¦ˆ UI */
        #setup-screen, #test-screen, #result-screen { width: 100%; max-width: 500px; text-align: center; display: none; padding: 20px; z-index: 10; }
        .quiz-container { background: white; padding: 40px 30px; border-radius: 25px; border-top: 10px solid var(--wm-yellow); box-shadow: 0 10px 20px rgba(0,0,0,0.05); position: relative; }
        #feedback-layer { position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); opacity: 0; transition: 0.2s; width: 100%; }
        #feedback-img { width: 150px; }
        .word-eng { font-size: 3.5rem; color: var(--wm-navy); font-weight: bold; margin-bottom: 25px; }
        .option-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .opt-btn { padding: 15px; border: 3px solid transparent; background: #f8f8f8; border-radius: 12px; cursor: pointer; font-size: 1.1rem; font-weight: bold; }
        .action-btn { width: 100%; padding: 18px; margin-top: 15px; border: none; border-radius: 12px; font-size: 1.2rem; cursor: pointer; background: var(--wm-navy); color: white; font-weight: bold; }
        
        #progress-box { position: fixed; top: 20px; right: 20px; font-size: 1.5rem; font-weight: bold; display: none; color: var(--wm-navy); }
        #time-bar-container { position: fixed; right: 30px; top: 50%; transform: translateY(-50%); width: 15px; height: 300px; background: #ddd; border-radius: 10px; overflow: hidden; display: none; }
        #time-bar-fill { width: 100%; height: 0%; background: var(--wm-red); position: absolute; top: 0; }
        #countdown { position: fixed; display: none; font-size: 10rem; color: var(--wm-yellow); font-weight: 900; z-index: 200; text-shadow: 8px 8px 0px var(--wm-navy); }
#countdown { 
            position: fixed; display: none; font-size: 10rem; 
            color: var(--wm-yellow); font-weight: 900; z-index: 200; 
            text-shadow: 8px 8px 0px var(--wm-navy); 
        }

        /* ì—¬ê¸°ì— ì¶”ê°€í•˜ì„¸ìš”! */
        .btn-retry:hover {
            background: #e63939; 
            transform: translateY(-2px);
            transition: all 0.2s;
        }

        .btn-home:hover {
            background: #e0e0e0;
            transform: translateY(-2px);
            transition: all 0.2s;
        }

        .review-container::-webkit-scrollbar {
            width: 6px;
        }
        .review-container::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 10px;
        }
    </style> </head>
    
<body>

    <div id="main-container">
        <div id="progress-box"><span id="curr-num">0</span> / <span id="total-num">0</span></div>
        <div id="time-bar-container"><div id="time-bar-fill"></div></div>
        <div id="countdown"></div>

        <div id="main-menu">
            <h1 style="color:var(--wm-navy); font-size: 3.5rem; margin-bottom: 30px;">WordRex Master</h1>
            <div class="slider-wrapper">
                <button class="slide-btn prev-btn" onclick="moveSlide(-1)">â®</button>
                <div class="book-container" id="book-slider"></div>
                <button class="slide-btn next-btn" onclick="moveSlide(1)">â¯</button>
            </div>
        </div>

        <div id="setup-screen">
            <h2 id="setup-title" style="color:var(--wm-navy);">í•™ìŠµ ì„¤ì •</h2>
            <select id="day-picker" style="padding: 12px; font-size: 1.1rem; border-radius: 10px; width: 250px; margin-bottom: 20px;"></select>
            <div style="margin: 20px 0;">
                <label style="font-weight:bold;">ë¬¸í•­ ìˆ˜ ì…ë ¥ (1~40):</label><br>
                <input type="number" id="quest-count" style="width: 120px; padding: 12px; font-size: 1.3rem; border-radius: 10px; border: 2px solid var(--wm-navy); text-align:center; margin:15px;" value="10" min="1" max="40">
            </div>
            <button class="action-btn" style="background:var(--wm-yellow); color:black;" onclick="startTest()">í…ŒìŠ¤íŠ¸ ì‹œì‘!</button>
        </div>

        <div id="test-screen">
            <div class="quiz-container">
                <div id="feedback-layer">
                    <img id="feedback-img" src="">
                    <div id="feedback-points" style="font-size: 4rem; font-weight: 900;"></div>
                </div>
                <div class="word-eng" id="word-display">Word</div>
                <div class="option-grid" id="option-area"></div>
            </div>
        </div>

        <div id="result-screen">
    <h2 style="color:var(--wm-navy); letter-spacing: 2px;">TEST COMPLETE</h2>
    <div style="font-size:5rem; font-weight:900; color:var(--wm-navy); margin: 20px 0;" id="final-score">0</div>
    
    <button class="action-btn" onclick="location.reload()">í™ˆìœ¼ë¡œ</button>
    <button class="secondary-btn" onclick="showWrongReview()">ì˜¤ë‹µ í™•ì¸í•˜ê¸°</button>
</div>

<div id="review-screen">
    <h2 style="color:var(--wm-navy); margin-bottom: 20px;">ì˜¤ë‹µ ë…¸íŠ¸</h2>
    
    <div class="review-container" id="review-list">
        </div>

    <div class="btn-group">
        <button class="half-btn btn-home" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ</button>
        <button class="half-btn btn-retry" onclick="retryWrongWords()">ì˜¤ë‹µ ë¿Œì‹œëŸ¬ ê°€ê¸°</button>
    </div>
</div>

    <audio id="snd-correct" src="correct.mp3"></audio>
    <audio id="snd-wrong" src="wrong.mp3"></audio>

    <script>
        const books = [
            { id: 1, name: "ê³ ë“± ë² ì´ì§", img: "cover.png", stars: "â­", desc: "ê³ êµ ê¸°ì´ˆ í•„ìˆ˜ ì˜ë‹¨ì–´" },
            { id: 2, name: "ê³ ë“± Complete", img: "cover2.png", stars: "â­â­", desc: "ìˆ˜ëŠ¥ 1ë“±ê¸‰ ì™„ì„± ì–´íœ˜" },
            { id: 3, name: "ìˆ˜ëŠ¥ 2000", img: "cover3.png", stars: "â­â­â­", desc: "ìˆ˜ëŠ¥ ë¹ˆì¶œ í•„ìˆ˜ ì–´íœ˜" },
            { id: 4, name: "í•˜ì´ìŠ¤íŠ¸", img: "cover4.png", stars: "â­â­â­â­", desc: "ê³ ë‚œë„ ì‹¬í™” ì–´íœ˜" }
        ];

        // 40ê°œ ë‹¨ì–´ ì „ì²´ ë°ì´í„°
        const baseWords = [
            { eng: "include", kor: "í¬í•¨í•˜ë‹¤", opts: ["í¬í•¨í•˜ë‹¤", "ì œì™¸í•˜ë‹¤", "ìƒì‚°í•˜ë‹¤", "ì˜ˆì¸¡í•˜ë‹¤", "ë§‰ë‹¤"] },
            { eng: "produce", kor: "ìƒì‚°í•˜ë‹¤", opts: ["ê³µê¸‰í•˜ë‹¤", "ìƒì‚°í•˜ë‹¤", "ê°ì†Œí•˜ë‹¤", "ê±°ë¶€í•˜ë‹¤", "í‘œí˜„í•˜ë‹¤"] },
            { eng: "belief", kor: "ë¯¿ìŒ", opts: ["ì˜ì‹¬", "ë¯¿ìŒ", "ê°ì •", "ê²½í—˜", "ëª©í‘œ"] },
            { eng: "similar", kor: "ë¹„ìŠ·í•œ", opts: ["ë¹„ìŠ·í•œ", "ë‹¤ë¥¸", "ì¤‘ìš”í•œ", "ì‹¤ìš©ì ì¸", "í™•ì‹¤í•œ"] },
            { eng: "moment", kor: "ìˆœê°„", opts: ["ìˆœê°„", "ì„±ê³µ", "ì–‘", "ìƒí™©", "ê°ì •"] },
            { eng: "situation", kor: "ìƒí™©", opts: ["ìœ„ì¹˜", "ìƒí™©", "ìˆœê°„", "ê²°ê³¼", "ëª©í‘œ"] },
            { eng: "improve", kor: "ê°œì„ í•˜ë‹¤", opts: ["ê°ì†Œí•˜ë‹¤", "ê°œì„ í•˜ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ê³µìœ í•˜ë‹¤", "ì‚¬ë¼ì§€ë‹¤"] },
            { eng: "increase", kor: "ì¦ê°€í•˜ë‹¤", opts: ["ê°ì†Œí•˜ë‹¤", "ì¦ê°€í•˜ë‹¤", "ì œê³µí•˜ë‹¤", "íšŒë³µí•˜ë‹¤", "í‘œí˜„í•˜ë‹¤"] },
            { eng: "decrease", kor: "ê°ì†Œí•˜ë‹¤", opts: ["ì¦ê°€í•˜ë‹¤", "ì‚¬ë¼ì§€ë‹¤", "ê°ì†Œí•˜ë‹¤", "ê°œì„ í•˜ë‹¤", "ê³µê¸‰í•˜ë‹¤"] },
            { eng: "share", kor: "ê³µìœ í•˜ë‹¤", opts: ["ìˆ¨ê¸°ë‹¤", "ê³µìœ í•˜ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ì˜ì¡´í•˜ë‹¤", "ë§‰ë‹¤"] },
            { eng: "emotion", kor: "ê°ì •", opts: ["ê°ì •", "ê²½í—˜", "ë¯¿ìŒ", "ì„±ê³µ", "ëª©í‘œ"] },
            { eng: "common", kor: "í”í•œ", opts: ["ë“œë¬¸", "í”í•œ", "ìƒê¸‰ì˜", "ì•½ê°„ì˜", "í™•ì‹¤í•œ"] },
            { eng: "recover", kor: "íšŒë³µí•˜ë‹¤", opts: ["ì‚¬ë¼ì§€ë‹¤", "íšŒë³µí•˜ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ì˜ì¡´í•˜ë‹¤", "í‘œí˜„í•˜ë‹¤"] },
            { eng: "advanced", kor: "ì§„ë³´í•œ", opts: ["ê¸°ì´ˆì ì¸", "ì§„ë³´í•œ", "ì•½ê°„ì˜", "í”í•œ", "ë¬´ê´€ì‹¬í•œ"] },
            { eng: "indifferent", kor: "ë¬´ê´€ì‹¬í•œ", opts: ["ì—´ì •ì ì¸", "ë¬´ê´€ì‹¬í•œ", "í™•ì‹¤í•œ", "ì‹¤ìš©ì ì¸", "ë¹„ìŠ·í•œ"] },
            { eng: "reject", kor: "ê±°ì ˆí•˜ë‹¤", opts: ["ìˆ˜ë½í•˜ë‹¤", "ê±°ì ˆí•˜ë‹¤", "ì œê³µí•˜ë‹¤", "ì˜ì¡´í•˜ë‹¤", "ê³µìœ í•˜ë‹¤"] },
            { eng: "refuse", kor: "ê±°ë¶€í•˜ë‹¤", opts: ["ë°›ì•„ë“¤ì´ë‹¤", "ê±°ë¶€í•˜ë‹¤", "íšŒë³µí•˜ë‹¤", "í‘œí˜„í•˜ë‹¤", "ì¦ê°€í•˜ë‹¤"] },
            { eng: "accept", kor: "ë°›ì•„ë“¤ì´ë‹¤", opts: ["ê±°ì ˆí•˜ë‹¤", "ë°›ì•„ë“¤ì´ë‹¤", "ë¬´ì‹œí•˜ë‹¤", "ì‚¬ë¼ì§€ë‹¤", "ì¤„ì´ë‹¤"] },
            { eng: "experience", kor: "ê²½í—˜í•˜ë‹¤", opts: ["ì˜ˆì¸¡í•˜ë‹¤", "ê²½í—˜í•˜ë‹¤", "ê³µê¸‰í•˜ë‹¤", "ì˜ì¡´í•˜ë‹¤", "ê°œì„ í•˜ë‹¤"] },
            { eng: "certain", kor: "í™•ì‹¤í•œ", opts: ["ë¶ˆí™•ì‹¤í•œ", "í™•ì‹¤í•œ", "ì•½ê°„ì˜", "í”í•œ", "ë¬´ê´€ì‹¬í•œ"] },
            { eng: "consider", kor: "ê³ ë ¤í•˜ë‹¤", opts: ["ë¬´ì‹œí•˜ë‹¤", "ê³ ë ¤í•˜ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ì‚¬ë¼ì§€ë‹¤", "ì¦ê°€í•˜ë‹¤"] },
            { eng: "supply", kor: "ê³µê¸‰í•˜ë‹¤", opts: ["ì°¨ë‹¨í•˜ë‹¤", "ê³µê¸‰í•˜ë‹¤", "ê±°ì ˆí•˜ë‹¤", "ê°ì†Œí•˜ë‹¤", "ì˜ì¡´í•˜ë‹¤"] },
            { eng: "provide", kor: "ì œê³µí•˜ë‹¤", opts: ["ì œê³µí•˜ë‹¤", "ìˆ¨ê¸°ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ì¤„ì´ë‹¤", "ì‚¬ë¼ì§€ë‹¤"] },
            { eng: "practical", kor: "ì‹¤ìš©ì ì¸", opts: ["ì´ë¡ ì ì¸", "ì‹¤ìš©ì ì¸", "ê°ì •ì ì¸", "í™•ì‹¤í•œ", "ì•½ê°„ì˜"] },
            { eng: "express", kor: "í‘œí˜„í•˜ë‹¤", opts: ["ìˆ¨ê¸°ë‹¤", "í‘œí˜„í•˜ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ì˜ì¡´í•˜ë‹¤", "í¬í•¨í•˜ë‹¤"] },
            { eng: "quantity", kor: "ì–‘", opts: ["ì§ˆ", "ì–‘", "ìˆœê°„", "ê°ì •", "ëª©í‘œ"] },
            { eng: "superior", kor: "ìš°ì›”í•œ", opts: ["ì—´ë“±í•œ", "ìš°ì›”í•œ", "ë¹„ìŠ·í•œ", "ë¬´ê´€ì‹¬í•œ", "í”í•œ"] },
            { eng: "inferior", kor: "ì—´ë“±í•œ", opts: ["ìš°ì›”í•œ", "ì—´ë“±í•œ", "í™•ì‹¤í•œ", "ì‹¤ìš©ì ì¸", "ì§„ë³´í•œ"] },
            { eng: "seek", kor: "ì°¾ë‹¤", opts: ["í”¼í•˜ë‹¤", "ì°¾ë‹¤", "ê±°ë¶€í•˜ë‹¤", "ì˜ì¡´í•˜ë‹¤", "ì¤„ì´ë‹¤"] },
            { eng: "aim", kor: "ëª©í‘œ", opts: ["ê³¼ì •", "ëª©í‘œ", "ê²°ê³¼", "ìƒí™©", "ê²½í—˜"] },
            { eng: "fade", kor: "í¬ë¯¸í•´ì§€ë‹¤", opts: ["ëšœë ·í•´ì§€ë‹¤", "í¬ë¯¸í•´ì§€ë‹¤", "íšŒë³µí•˜ë‹¤", "ì¦ê°€í•˜ë‹¤", "ë‚˜íƒ€ë‚˜ë‹¤"] },
            { eng: "disappear", kor: "ì‚¬ë¼ì§€ë‹¤", opts: ["ë‚˜íƒ€ë‚˜ë‹¤", "ì‚¬ë¼ì§€ë‹¤", "ì¦ê°€í•˜ë‹¤", "ìœ ì§€í•˜ë‹¤", "ê°œì„ í•˜ë‹¤"] },
            { eng: "emerge", kor: "ë‚˜íƒ€ë‚˜ë‹¤", opts: ["ìˆ¨ë‹¤", "ë‚˜íƒ€ë‚˜ë‹¤", "ì‚¬ë¼ì§€ë‹¤", "ì¤„ì´ë‹¤", "ì˜ì¡´í•˜ë‹¤"] },
            { eng: "grief", kor: "ìŠ¬í””", opts: ["ê¸°ì¨", "ìŠ¬í””", "ì„±ê³µ", "ëª©í‘œ", "í™•ì‹¤í•¨"] },
            { eng: "slight", kor: "ì•½ê°„ì˜", opts: ["ì¤‘ëŒ€í•œ", "ì•½ê°„ì˜", "í™•ì‹¤í•œ", "ìš°ì›”í•œ", "í”í•œ"] },
            { eng: "success", kor: "ì„±ê³µ", opts: ["ì‹¤íŒ¨", "ì„±ê³µ", "ê²½í—˜", "ê°ì •", "ìƒí™©"] },
            { eng: "failure", kor: "ì‹¤íŒ¨", opts: ["ì„±ê³µ", "ì‹¤íŒ¨", "ëª©í‘œ", "ê²½í—˜", "í‘œí˜„"] },
            { eng: "run into", kor: "ìš°ì—°íˆ ë§Œë‚˜ë‹¤", opts: ["í”¼í•˜ë‹¤", "ìš°ì—°íˆ ë§Œë‚˜ë‹¤", "ì˜ì¡´í•˜ë‹¤", "ì œê³µí•˜ë‹¤", "ë§‰ë‹¤"] },
            { eng: "depend on", kor: "~ì— ì˜ì¡´í•˜ë‹¤", opts: ["ê±°ë¶€í•˜ë‹¤", "ì‚­ì œí•˜ë‹¤", "ê³µìœ í•˜ë‹¤", "í‘œí˜„í•˜ë‹¤", "ì¤„ì´ë‹¤"] },
            { eng: "carry out", kor: "ìˆ˜í–‰í•˜ë‹¤", opts: ["ì¤‘ë‹¨í•˜ë‹¤", "ìˆ˜í–‰í•˜ë‹¤", "ê±°ì ˆí•˜ë‹¤", "ì˜ì¡´í•˜ë‹¤", "ì‚¬ë¼ì§€ë‹¤"] }
        ];

        let currentSlideIdx = 0;
        let gameWords = [];
        let currentIdxQ = 0;
        let score = 0;
        let tInt;
        let sliding = false;
        let answering = false;
        let wrongList = [];   // ì´ë²ˆ í…ŒìŠ¤íŠ¸ ì˜¤ë‹µ ì €ì¥
let isWrongMode = false; // ì˜¤ë‹µë§Œ í…ŒìŠ¤íŠ¸ ì¤‘ì¸ì§€ ì—¬ë¶€


        const slider = document.getElementById('book-slider');

        function showWrongReview() {
    const area = document.getElementById('result-screen');

    if (wrongList.length === 0) {
        area.innerHTML += "<p>ì˜¤ë‹µì´ ì—†ìŠµë‹ˆë‹¤ ğŸ‘</p>";
        return;
    }

    area.innerHTML = `
        <h2>ì˜¤ë‹µ í™•ì¸</h2>

        <div class="wrong-list">
            ${wrongList.map((q, i) => `
                <div class="wrong-item">
                    <b>${i + 1}. ${q.eng}</b>
                    <div>ì •ë‹µ: ${q.kor}</div>
                </div>
            `).join('')}
        </div>

        <button onclick="goHome()">ì²˜ìŒìœ¼ë¡œ</button>
        <button onclick="startWrongTest()">ì˜¤ë‹µ ë¿Œì‹œëŸ¬ ê°€ê¸°</button>
    `;
}

        function startWrongTest() {
    if (wrongList.length === 0) {
        alert("ì˜¤ë‹µì´ ì—†ìŠµë‹ˆë‹¤!");
        return;
    }

    isWrongMode = true;
    gameWords = [...wrongList];   // âœ… ì˜¤ë‹µë§Œìœ¼ë¡œ í…ŒìŠ¤íŠ¸
    currentIdxQ = 0;
    score = 0;

    document.getElementById('result-screen').style.display = 'none';
    document.getElementById('test-screen').style.display = 'block';
    document.getElementById('progress-box').style.display = 'block';
    document.getElementById('time-bar-container').style.display = 'block';

    loadQuestion();
}

        function renderSlider() {
    slider.innerHTML = '';

    books.forEach((book, i) => {
        const card = document.createElement('div');
        card.className = 'book-card';
        card.dataset.index = i;

        card.style.backgroundImage = `url('${book.img}')`;

        card.innerHTML = `
            <div class="overlay">
                <div class="stars">${book.stars}</div>
                <h3>${book.name}</h3>
                <p>${book.desc}</p>
                <div class="start-badge">START</div>
            </div>
        `;

        card.onclick = () => {
            if (i === (currentSlideIdx - 1 + books.length) % books.length) moveSlide(-1);
            else if (i === (currentSlideIdx + 1) % books.length) moveSlide(1);
            else if (i === currentSlideIdx) showSetup(book.name);
        };

        slider.appendChild(card);
    });

    updateSlideClasses();
}

        function moveSlide(dir) {
    currentSlideIdx = (currentSlideIdx + dir + books.length) % books.length;
    updateSlideClasses();
}

        function showSetup(title) {
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('setup-screen').style.display = 'block';
            document.getElementById('setup-title').innerText = title + " ì„¤ì •";
            const picker = document.getElementById('day-picker');
            picker.innerHTML = '';
            for(let i=1; i<=30; i++) {
                let opt = document.createElement('option');
                opt.value = i; opt.innerText = `Day ${i}`;
                picker.appendChild(opt);
            }
        }

        function startTest() {
    const count = parseInt(document.getElementById('quest-count').value);
    gameWords = [...baseWords].sort(() => Math.random() - 0.5).slice(0, count);

    wrongList = [];        // âœ… ì˜¤ë‹µ ì´ˆê¸°í™”
    isWrongMode = false;   // âœ… ì¼ë°˜ í…ŒìŠ¤íŠ¸ ëª¨ë“œ

    document.getElementById('setup-screen').style.display = 'none';
    score = 0; currentIdxQ = 0;
    document.getElementById('total-num').innerText = gameWords.length;
    startCountdown();
}

        function startCountdown() {
            const el = document.getElementById('countdown');
            el.style.display = 'block';
            let i = 3;
            const t = setInterval(() => {
                el.innerText = i > 0 ? i : "GO!";
                if(i < 0) { clearInterval(t); el.style.display='none'; runQuiz(); }
                i--;
            }, 800);
        }

        function updateSlideClasses() {
    const cards = document.querySelectorAll('.book-card');

    cards.forEach(card => {
        card.classList.remove('active', 'prev', 'next');
        const i = Number(card.dataset.index);

        if (i === currentSlideIdx) {
            card.classList.add('active');
        } else if (i === (currentSlideIdx - 1 + books.length) % books.length) {
            card.classList.add('prev');
        } else if (i === (currentSlideIdx + 1) % books.length) {
            card.classList.add('next');
        }
    });
}

        function runQuiz() {
            document.getElementById('progress-box').style.display = 'block';
            document.getElementById('test-screen').style.display = 'block';
            document.getElementById('time-bar-container').style.display = 'block';
            loadQuestion();
        }

        function loadQuestion() {
    if(currentIdxQ >= gameWords.length) { endGame(); return; }

    answering = false;   // âœ… ì—¬ê¸° ì¤‘ìš”

    const q = gameWords[currentIdxQ];
    document.getElementById('curr-num').innerText = currentIdxQ + 1;
    document.getElementById('word-display').innerText = q.eng;

    const area = document.getElementById('option-area');
    area.innerHTML = '';

    [...q.opts].sort(() => Math.random() - 0.5).forEach(o => {
        const b = document.createElement('button');
        b.className = 'opt-btn';
        b.innerText = o;
        b.onclick = () => check(o, b);
        area.appendChild(b);
    });

    resetTimer();
}

function check(o, b) {
    if (answering) return;
    answering = true;

    clearInterval(tInt);

    document.querySelectorAll('.opt-btn').forEach(btn => {
        btn.disabled = true;
        btn.style.pointerEvents = 'none';
    });

    const q = gameWords[currentIdxQ];
    const layer = document.getElementById('feedback-layer');
    const img = document.getElementById('feedback-img');
    const pts = document.getElementById('feedback-points');

    if (o === q.kor) {
        score += 100;
        img.src = "good.png";
        pts.innerText = "+100";
        pts.style.color = "var(--wm-green)";
        document.getElementById('snd-correct').play().catch(()=>{});
    } else {
        score -= 50;
        img.src = "ë˜¥.png";
        pts.innerText = "-50";
        pts.style.color = "var(--wm-red)";
        document.getElementById('snd-wrong').play().catch(()=>{});
        if (b) b.style.borderColor = "var(--wm-red)";
        wrongList.push(q);   // âœ… ì˜¤ë‹µ ì €ì¥
    }

    layer.style.opacity = 1;

    setTimeout(() => {
        layer.style.opacity = 0;
        currentIdxQ++;
        loadQuestion();
    }, 1000);
}


        function resetTimer() {
            clearInterval(tInt);
            let left = 8;
            tInt = setInterval(() => {
                left -= 0.1;
                document.getElementById('time-bar-fill').style.height = ((8-left)/8*100) + "%";
                if(left <= 0) check("TIMEOUT", null);
            }, 100);
        }

        function endGame() {
            document.getElementById('test-screen').style.display = 'none';
            document.getElementById('time-bar-container').style.display = 'none';
            document.getElementById('progress-box').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            document.getElementById('final-score').innerText = score;
        }

        renderSlider();
    </script>
</body>

</html>
